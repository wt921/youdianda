"use strict";(self["webpackChunkyoudianda"]=self["webpackChunkyoudianda"]||[]).push([[266],{3266:function(t,i,e){e.r(i),e.d(i,{default:function(){return k}});var a=function(){var t=this,i=t._self._c;return i("div",{staticClass:"articleDetails"},[i("van-nav-bar",{staticClass:"page-nav-bar",attrs:{"left-arrow":"",title:"文章详情",fixed:""},on:{"click-left":function(i){return t.$router.back()}}}),i("div",{staticClass:"article-detail markdown-body"},[1===t.statusCode?i("div",{staticClass:"loading-wrap"},[i("van-loading",{attrs:{color:"#3296fa",vertical:""}},[t._v("加载中")])],1):t._e(),2===t.statusCode?i("div",{staticClass:"article-detail"},[i("h1",{staticClass:"article-title"},[t._v(t._s(t.arcicleList.title))]),i("van-cell",{staticClass:"user-info",attrs:{center:"",border:!1}},[i("van-image",{staticClass:"avatar",attrs:{slot:"icon",width:".85333rem;",round:"",fit:"cover",src:"http://122.51.249.55:8060/"+t.arcicleList.pic},slot:"icon"}),i("div",{staticClass:"user-name",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.arcicleList.author))]),i("div",{staticClass:"publish-date",attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t._f("relativeTime")(t.arcicleList.create_date))+" ")])],1),i("div",{ref:"content",staticClass:"article-content markdown-body",domProps:{innerHTML:t._s(t.arcicleList.content)}}),i("van-divider",[t._v("正文结束")]),i("div",{staticClass:"article-recommend"},[i("h3",{staticClass:"recommend"},[t._v("相关推荐")]),i("van-grid",{attrs:{"column-num":2,border:!0}},t._l(t.recommendList,(function(e){return i("van-grid-item",{key:e.id},[i("van-image",{staticClass:"pic",attrs:{height:"80",width:"70%",src:"http://122.51.249.55:8060/"+e.pic}}),i("p",{staticClass:"ydd-txt"},[t._v(t._s(e.title))])],1)})),1)],1),i("div",{staticClass:"article-bottom",staticStyle:{position:"fixed"}},[i("collectArticle",{attrs:{articleId:t.arcicleList.id},model:{value:t.arcicleList.isCollect,callback:function(i){t.$set(t.arcicleList,"isCollect",i)},expression:"arcicleList.isCollect"}}),i("zanArticle",{attrs:{articleId:t.arcicleList.id,"is-attitude":t.arcicleList.isLike},on:{"update:isAttitude":function(i){return t.$set(t.arcicleList,"isLike",i)},"update:is-attitude":function(i){return t.$set(t.arcicleList,"isLike",i)}}}),i("van-button",{attrs:{icon:"share",type:"default"}})],1)],1):t._e(),4===t.statusCode?i("div",{staticClass:"error-wrap"},[i("van-icon",{attrs:{name:"failure"}}),i("p",{staticClass:"text"},[t._v("内容加载失败！")]),i("van-button",{staticClass:"retry-btn"},[t._v("点击重试")])],1):t._e(),3===t.statusCode?i("div",{staticClass:"error-wrap"},[i("van-icon",{attrs:{name:"failure"}}),i("p",{staticClass:"text"},[t._v("内容加载失败！")]),i("van-button",{staticClass:"retry-btn",on:{click:t.getArticleDetail}},[t._v("点击重试")])],1):t._e()])],1)},s=[],r=(e(1958),e(6196),e(3332),e(6742),e(7179),e(2666),e(2939),e(9137),e(1088),e(6300),e(6471)),l=e(8572),c=function(){var t=this,i=t._self._c;return t.isLoading?i("van-loading",{attrs:{type:"spinner"}}):i("van-icon",{attrs:{color:t.value?"#5094f3":"#777",name:t.value?"star":"star-o"},on:{click:t.collectHandler}})},o=[],n={name:"collectArticle",data(){return{isLoading:!1,obj:{type:1,action:"add"},obj2:{type:1,action:"del"}}},props:{value:{type:Boolean,required:!0},articleId:{type:[String,Number],required:!0}},methods:{async collectHandler(){if(!this.$store.getters.token)return this.$toast.fail("请登录");this.isLoading=!0;try{if(this.value){const t=await(0,l.vO)({article_id:this.articleId,...this.obj2});console.log("quxiao",t)}else{const t=await(0,l.Mh)({article_id:this.articleId,...this.obj});console.log("guanzhu",t)}this.$toast.success(this.value?"取消成功":"收藏成功"),this.$emit("input",!this.value)}catch(t){this.$toast.fail("操作失败！"),console.log(t)}this.isLoading=!1}}},d=n,u=e(1001),h=(0,u.Z)(d,c,o,!1,null,null,null),v=h.exports,m=function(){var t=this,i=t._self._c;return t.isLoading?i("van-loading",{attrs:{type:"spinner"}}):i("van-icon",{attrs:{color:t.isAttitude?"#5094f3":"#777",name:t.isAttitude?"good-job":"good-job-o"},on:{click:t.zanHandler}})},p=[],f={name:"collectArticle",data(){return{isLoading:!1,obj:{type:2,action:"add"},obj2:{type:2,action:"del"}}},props:{isAttitude:{type:Boolean,required:!0},articleId:{type:[String,Number],required:!0}},methods:{async zanHandler(){if(!this.$store.getters.token)return this.$toast.fail("请登录");this.isLoading=!0;try{this.isAttitude?await(0,l.vO)({article_id:this.articleId,...this.obj2}):await(0,l.Mh)({article_id:this.articleId,...this.obj}),this.$toast.success(this.isAttitude?"取消成功":"点赞成功"),this.$emit("update:isAttitude",!this.isAttitude)}catch(t){this.$toast.fail("操作失败！"),console.log(t)}this.isLoading=!1}}},g=f,C=(0,u.Z)(g,m,p,!1,null,null,null),b=C.exports,_={name:"articleIndex",data(){return{id:this.$route.query.id,arcicleList:[],recommendList:[],statusCode:1}},components:{collectArticle:v,zanArticle:b},created(){this.getArticleDetail(),console.log(this.$route)},methods:{async getArticleDetail(){this.statusCode=1;try{let{data:t}=await(0,l.xr)({id:this.id});if(console.log(t),1e3===t.errno)return this.statusCode=4;this.arcicleList=t.data.info,this.recommendList=t.data.recommend,this.statusCode=2,this.$nextTick((()=>{const t=this.$refs.content.querySelectorAll("img"),i=Array.from(t).map((t=>t.src));t.forEach(((t,e)=>{t.onclick=function(){(0,r.Z)({images:i,startPosition:e})}}))}))}catch(t){this.statusCode=3,console.log(t)}}}},L=_,y=(0,u.Z)(L,a,s,!1,null,"48bb0b1e",null),k=y.exports},8572:function(t,i,e){e.d(i,{Mh:function(){return r},vO:function(){return l},xr:function(){return s}});var a=e(4471);const s=t=>(0,a.Z)({url:"/home/index/show",method:"get",params:t}),r=t=>(0,a.Z)({url:"/user/userDataHandle",method:"get",params:t}),l=t=>(0,a.Z)({url:"/user/userDataHandle",method:"get",params:t})}}]);